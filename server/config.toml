# PlayPalace Server Configuration
# Copy this file to config.toml and customize as needed.

[auth]
# These limits are enforced during both login and registration.
username_min_length = 3
username_max_length = 32
password_min_length = 8
password_max_length = 128
[auth.rate_limits]
login_per_minute = 5
login_failures_per_minute = 3
registration_per_minute = 2

[network]
# Maximum bytes accepted per websocket message (maps to websockets' max_size)
max_message_bytes = 1048576
# Allow ws:// without TLS (only for trusted local development)
allow_insecure_ws = false

[server]
# Tick interval in milliseconds (default: 50ms = 20 ticks/sec)
# Lower values = faster game updates but more CPU usage
# Higher values = slower updates but less CPU usage
tick_interval_ms = 50

[virtual_bots]
# Bot names - these will be used for virtual bot usernames
names = [
    "Alex", "Jordan", "Taylor", "Morgan", "Casey",
    "Riley", "Quinn", "Avery", "Skyler", "Jamie",
    "Phoenix", "River", "Sage", "Rowan", "Finley"
]

# Timing settings (in ticks, 50ms each = 20 ticks/sec)
min_idle_ticks = 20       # 1 sec minimum between actions when idle
max_idle_ticks = 60       # 3 sec maximum between actions when idle
min_online_ticks = 1000000    # Effectively keep bots online indefinitely
max_online_ticks = 1000000    # Effectively keep bots online indefinitely
min_offline_ticks = 0     # Irrelevant when bots never go offline
max_offline_ticks = 0     # Irrelevant when bots never go offline
leave_game_delay_ticks = 0    # Don't stagger departures once required
start_game_delay_ticks = 200  # 10 sec - wait for players before starting

# Behavior probabilities (per decision tick when idle)
join_game_chance = 0.6    # Chance to try joining an existing game
create_game_chance = 0.2  # Chance to try creating a new game
go_offline_chance = 0.0   # Bots remain online indefinitely

# Post-game logout behavior
logout_after_game_chance = 0.0     # Bots never log off after finishing a game
logout_after_game_min_ticks = 0    # No logout delay needed
logout_after_game_max_ticks = 0    # No logout delay needed

# Maximum tables virtual bots can own per game type (0 = unlimited)
# This limit applies to each game type separately.
# E.g., if set to 2, bots can own up to 2 scopa tables AND 2 ninetynine tables, etc.
max_tables_per_game = 1
# Default guided-table seat bounds for bots that don't have profile overrides
min_bots_per_table = 0
max_bots_per_table = 0
# Waiting window (in ticks) before bots retry joining a guided table after failure
waiting_min_ticks = 40
waiting_max_ticks = 100

# Behavior when no guided-table rule applies
#   "default"  - bots fall back to the probabilistic join/create logic
#   "disabled" - bots stay idle/offline unless a guided slot explicitly needs them
fallback_behavior = "disabled"
# Default profile applied to bots without an explicit profile assignment
default_profile = "default"
# Allocation policy when total bot pool can't satisfy all guided min_bots
#   "best_effort" (default) fills higher-priority tables first and warns if short
#   "strict" fails fast at startup if requirements exceed the pool
allocation_mode = "best_effort"

[virtual_bots.profiles.default]
# Profiles inherit any keys omitted here from the top-level [virtual_bots] block
min_bots_per_table = 0
max_bots_per_table = 4




[virtual_bots.bot_groups.all_bots]
# All virtual bots use the default profile
bots = ["Alex", "Jordan", "Taylor", "Morgan", "Casey", "Riley", "Quinn", "Avery", "Skyler", "Jamie", "Phoenix", "River", "Sage", "Rowan", "Finley"]



# Optional guided table rules pin bots to specific tables/channels.
# Each rule lists the bot groups allowed to fill it, the enforced bot counts,
# and the deterministic priority (lower numbers first). Tables only host one game
# at a time, so add multiple entries if you want the same profile across games.
[[virtual_bots.guided_tables]]
table = "Crazy Table"
game = "crazyeights"
bot_groups = ["all_bots"]
min_bots = 4
max_bots = 4
priority = 10
