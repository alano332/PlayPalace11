# Documents system for Play palace
Documents are a collection of articles that the user can view to get help or information. Each document has categories and locales support.

# Roles
Server admins have full control over document organization and contents. However if only admins had access to the documents system, it would make locale support very difficult.
To account for this, admins can approve people to be transcribers. The transcriber role would allow for existing documents to support new translations. Transcribers can not manage documents, or create new ones. They can only create and edit translations.
Transcribers will be assigned a list of languages. They can only modify translations for the languages they are assigned. For example, a transcriber with Spanish and French would not be allowed to create or edit translations of an English version.

## Storing transcriber data
The user table in the database should have a new column called fluent_languages, which is a list of lang codes. For example ["en", "es"].
This can be used for more than just translation in the future.

# Backend folder structure
server/documents folder contains each document, and a "_metadata.json" file.

## Document System metadata file
In the root of the documents folder is a "_metadata.json" file. This file contains the following information:
*Categories dictionary: a dictionary for labeling things by category. A category has an id, and a display friendly name in each locale.

### Example
{
"categories": {
	"erjieri230120": {
		"en": "news and updates"
	}
	}
}

## Document specific folder
Each document will have its own folder, for example "uno_rules".
A document's folder contains the content in each locale. For example "en.md".
It also contains a "_metadata.json" file.

## Document metadata file
Contains the following:
*id: a string used by the document system
*Categories: the list of category ids this document belongs to.
*locales: a dictionary of locale codes and settings for each one

### Locale settings:
*Created: the timestamp this locale was created
*Modified_contents: the timestamp for when the document contents of this locale was last modified; this does not include changes to locale settings.
*Title: the title name of the document for this locale.
*Public: a boolean flag indicating if this locale is visible to normal users. If not, only transcribers and admins can see it.
	Transcribers of other languages would still have viewing access. For example a French transcriber would still be able to see the English version even when the English one is private. This is so the French transcriber knows what changes they need to update before either version of the document is publicly available.
	A transcriber can only change the visibility for languages they are assigned. For example, a French transcriber can not make an English translation public.
*Server_owner_only_edit: a boolean flag indicating if only the server owner can edit this translation. Usually this setting will be the same for all locales.

# Loading documents data
The folder names of the documents are not important. When loading documents, it should look at the metadata file for each document and use that instead.

# Frontend ui structure

## Documents system UI
Add a "Documents" action in the main menu. The documents menu has the following items:
*category x, display the category name for each category as its own item.
*manage categories, admins only.
*new document, admins only
*view transcribers by language
*view transcribers by user

## Documents in Category x menu
*search for a document
	Searches the list of documents via document contents. When searching, must choose a language to filter (current user's language by default), only one can be selected at a time.

## Manage categories menu
Show the list of category names. When clicking on one, ask to rename or delete it.
At the bottom of the menu add an add category item

## add document
Text field for backend document folder name. This is not an id.
Generate document id
Choose categories
Use the "add translation" section to prevent duplicating code. Pass the new document id and current user's locale to the add translation feature. So that it knows what document is being modified, and can skip choosing locale.

## View transcribers by language
Shows the standard language menu. Append each item with the number of users assigned to that language.
For example, English (4 users)
When clicking on a language, displays the list of users in a menu. If an admin, clicking on a user asks if you want to remove them.
If admin, at the bottom is an add users item.
When clicked, shows a list of users who do not have this assigned language, and status of on / off.

## View transcribers by user
This is the exact inverse of view transcribers by language.
Shows the list of transcribers as a menu. Append each item with the number of languages assigned to that user.
For example, Zarvox (4 languages)
When clicking on a user, displays the list of assigned languages in a menu. If an admin, clicking on a language asks if you want to remove it.
If admin, at the bottom is an add languages item.
When clicked, shows the standard language menu excluding the already assigned languages, and status of on / off.

## document actions menu.
When clicking on a document, brings up an action menu if the user is a transcriber or an admin, otherwise automatically chooses the view document action.

*View document: views  document in read only, allowing language selection.
*Edit document contents: edit the contents of the document if permitted, allowing language selection.
*Change title: changes the title of the document, allowing language selection.
*Manage visibility (x / x languages are public): allows for toggling which translations are publicly available to view, or private until ready for viewing or staff only content.
*add translation: adds a new language translation for this document. New translations are private when first created.
*Modify category list: changes the categories that the document belongs to. Only available for admins.

## Language Selection menu
After clicking an item that requires language selection, display the list of languages the document has been written, with the standard language menu. Append the created and last modified dates.
#user's current language as the initial focus. If their locale is not available for this document, focus them on English.
If a transcriber selects edit document contents or change title, only their assigned languages will be shown.

## Changing title
Brings up a text field for renaming the document. This modifies the value in "_metadata.json"
This does not rename the folder name of the document on the backend. That is not supported via the ui, and must be done manually when the server is offline.

## manage visibility
Show a list of assigned languages and allow toggling on and off.

## add translation
Select from the language menu, if that transcriber has any assigned languages that the document has not been written. Otherwise inform them that they can't do it.
Brings up a text field for the title, then a multiline text field for the contents.

## Modifying category list
Shows a menu with the items being category name and status i.e included or excluded. Pressing enter on an item toggles the status.

*ignore the rest of this document for now*

## Alert styles
This is an extension to the documents system that allows sending read only text dialogs to a user when certain events occur.
For example, display a message when the user logs in, or when they try to access a game that is in beta and not stable.
After selecting an event, select a future dismiss behavior.

### Available events:
*login: displays when the user logs in.
*beta table: displays when the user wants to create or join a table that is in beta.
*mature content: displays when the user creates or joins a table containing mature themes.
*language switch: displays when the user switches to another language.

### Future Dismiss behavior
Controls how the user can prevent this dialog from appearing in the future.
*ephemeral: the dialog is only shown to the user the first time they encounter it, no action needs to be taken.
*skippable: allows the user to select don't show again.
*mandatory: the user can not skip this dialog in the future.
